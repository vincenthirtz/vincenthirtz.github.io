{"componentChunkName":"component---src-templates-blog-post-js","path":"/automatisation-de-la-publication-du-blog/","webpackCompilationHash":"ad5d204bf31dfc096811","result":{"data":{"site":{"siteMetadata":{"title":"Blog de Vincent Hirtz","author":"Vincent Hirtz"}},"markdownRemark":{"id":"43c30048-37c6-54a1-a3ca-1b382d6340a6","excerpt":"Comment ce blog est-il d√©ploy√©, sur quelle infrastructure tourne-t-il, est-ce\nque tout est automatis√© ? Nous allons r√©pondre √† ces questions dans ce billet‚Ä¶","html":"<blockquote>\n<p>Comment ce blog est-il d√©ploy√©, sur quelle infrastructure tourne-t-il, est-ce\nque tout est automatis√© ? Nous allons r√©pondre √† ces questions dans ce billet.</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 560px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABf0lEQVQoz61T207CQBDtD6o/gE+SaPwW/AJMMLwgJviMvJNIBAKt4U5iaRHojd6A0BaOO5tACBb1wU2mm5yZOXN2z1bYbrc4FbR+yseFsGuMW2EYfsPi6g8xgT7zuY3JdIaZpjOSiBf4/gIb2hds32x4OK6HuW3D9X1eEwQBbMdluAuPYSCFtu1gMBhiNPpEu9PHhzziZK1WG3epFOr1OhzP402SJOG5UMBgOIRNJJ6PWrWGp3yeCZry4YKmG2g0RNxc3yJ5lUSjKTEVDh4yGZReSrhPpyErClcniSIeczl0O11Y7FSktvr2hmw2ywSN4BGhaVpMRRMXZ+e4TCTQ6fa5msprBeVyGcVikQ+YTKZQVRWyLENhA+h6TMvCeDxGr9eDYZr8+NwURVHRFN852WK5RBRFoKuwrDknD4IQ6/Uamq6zJgeaYfCa5WrFiUgpkdM9Czt3qIAZv3eLkkRC+DF26Crl18ycvcun3tzxs/gN27/DU0R/weJ+BAH/vL4AuqZF2B4l/T4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Sch√©ma du d√©ploiement du blog\"\n        title=\"Sch√©ma du d√©ploiement du blog\"\n        src=\"/static/b6d87a18c3222fffdc95edf7af095847/02744/blog-deployment.png\"\n        srcset=\"/static/b6d87a18c3222fffdc95edf7af095847/cf440/blog-deployment.png 148w,\n/static/b6d87a18c3222fffdc95edf7af095847/d2d38/blog-deployment.png 295w,\n/static/b6d87a18c3222fffdc95edf7af095847/02744/blog-deployment.png 560w\"\n        sizes=\"(max-width: 560px) 100vw, 560px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><a href=\"https://www.gatsbyjs.org/\">Gatsby</a>, c‚Äôest chouette, √ßa permet vraiment beaucoup de choses int√©ressantes\npour g√©rer du contenu (j‚Äôy reviendrai peut-√™tre lors d‚Äôun autre billet de blog),\nmais il y avait un truc qui ne me plaisait pas, c‚Äôest qu‚Äôil fallait que je lance\nplusieurs commandes, identiques √† chaque nouvel article, pour mettre √† jour mon\nsite‚Ä¶ Je suis d√©veloppeur, je suis pour l‚Äôautomatisation, je veux donc\noptimiser mon temps et gagner quelques secondes par-ci, par-l√†.</p>\n<h2>Github et Github Pages</h2>\n<p>Le code source du blog est h√©berg√© sur <a href=\"https://github.com\">Github</a>, √† des fins pratiques, car j‚Äôai\ntoutes mes sources sur cet outil car tous mes projets personnels sont publics\nsur le mod√®le du libre et de l‚ÄôOpen Source. <a href=\"https://github.com\">Github</a> permet de stocker le code\nsource de vos applications et bien plus, on le verra par la suite.</p>\n<p>J‚Äôai cr√©√© le d√©p√¥t de ce blog sous le nom <code class=\"language-text\">yoannfleurydev.github.io</code>, j‚Äôen\nparlais dans <a href=\"../mise-en-place-de-ce-blog\">mon pr√©c√©dent post</a> si vous l‚Äôavez\nmanqu√©.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 412px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.62135922330097%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAADABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdyFlB//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAZEAADAAMAAAAAAAAAAAAAAAAAAZERYYH/2gAIAQEAAT8hp10xt0//2gAMAwEAAgADAAAAEPgv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBAAAQMFAAAAAAAAAAAAAAAAAAERITFBkaHB/9oACAEBAAE/EGmuSjX2BIdB/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Catpure d&#39;√©cran du d√©p√¥t sur Github\"\n        title=\"Catpure d&#39;√©cran du d√©p√¥t sur Github\"\n        src=\"/static/d089fe2a92efc7696ee1980b2b338d3d/53d09/repository-name.jpg\"\n        srcset=\"/static/d089fe2a92efc7696ee1980b2b338d3d/8ee9c/repository-name.jpg 148w,\n/static/d089fe2a92efc7696ee1980b2b338d3d/ebbe7/repository-name.jpg 295w,\n/static/d089fe2a92efc7696ee1980b2b338d3d/53d09/repository-name.jpg 412w\"\n        sizes=\"(max-width: 412px) 100vw, 412px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Il faut savoir qu‚Äôen faisant cela, j‚Äôai directement acc√®s au <a href=\"https://pages.github.com/\">Github Pages</a> sur\nle domaine <a href=\"https://yoannfleurydev.github.io\">yoannfleurydev.github.io</a>. Allez\ny, cliquez, vous allez directement retomber sur l‚Äôaccueil du blog gr√¢ce √† la\nredirection que j‚Äôai d√©fini dans les param√®tres du d√©p√¥t.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.70627503337784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACB0lEQVQ4y5WU65KbMAyFef/Ha3fbHy3JbMI1Wa42vptTySRsMp3pNGS+yPJgIR0Jsq77xLkoUFYlPk5nOO/A14r/v1b+rRuZ1gFCBmjlIScJqy28cQjWwd3WVhmynqyFoTXf4/S2bxaD6OOWAZFd7Izf8oKDaHCYTjjOBY5p3SCfarI18rFCqS84LzU+ZIVCtSg0oZrkN+4T13XEEAWyOl7xw+X4aQ940zneTY43U+CbLvHdEGTfbYUDKhxRE1XigPJGhZzsr/WMYr0gU1rj2nWknU+EGOCD23HeJqyjci3hPBHgQkBcI90fk72TOdJqGEaM04Su69Oa6XtmgFwUlp0FC2kndaSH/N221BRLT+WD/TCkA+wbY5N1zv27t+sDNz9TSqEsK9R1g67vMc8CUi4QQibGccQkFkwqUGbhKchjZnuGrFt77VC3V1TNhXR7PvQqWaAA3oetISG+NNCP5d8loMHWaNs2lTzPMwX3Sbu7lsaYHa3Nk8ZJZ2qqdRGaCIGbQofHcUpwY4QQGKYZHXVaKZ2C8ENZa7bJT/tfe8oGIpJckUuO1AS5N4KzW+iQWPTrhaemUAAuZyvTvaba+hUoMvEWkDU8nQuylzQ2DA86a7r5M/nETINN5XJFacipZJaFdd8z5D/O8P4mcABBB+6Bt7kkXyr0s4Wirw8HeIRl4+wivYZ/AHh+3aU1lltFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Capture d&#39;√©cran des param√®tres de nom de domaine des Github Pages\"\n        title=\"Capture d&#39;√©cran des param√®tres de nom de domaine des Github Pages\"\n        src=\"/static/2a729b58ec4196b1f7dd7db20491b156/b9e4f/repository-settings-domain.png\"\n        srcset=\"/static/2a729b58ec4196b1f7dd7db20491b156/cf440/repository-settings-domain.png 148w,\n/static/2a729b58ec4196b1f7dd7db20491b156/d2d38/repository-settings-domain.png 295w,\n/static/2a729b58ec4196b1f7dd7db20491b156/b9e4f/repository-settings-domain.png 590w,\n/static/2a729b58ec4196b1f7dd7db20491b156/f5ece/repository-settings-domain.png 749w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Les <a href=\"https://pages.github.com/\">Github Pages</a> permettent l‚Äôh√©bergement d‚Äôun site statique, personnel ou\nbien pour de la documentation de projet. Je ne vais pas m‚Äô√©tendre sur le sujet\ndes Github Pages plus longuement, car la documentation de Github est plut√¥t\nbonne √† ce sujet, mais je vais juste pr√©venir que les Github Pages agissent\ndiff√©remment selon le type de d√©p√¥t:</p>\n<ul>\n<li>Si c‚Äôest un d√©p√¥t personnel sous format <code class=\"language-text\">username.github.io</code>, seule la branche\n<code class=\"language-text\">master</code> sera disponible √† l‚Äôh√©bergement, il faudra donc comme moi, si vous\nutilisez un outil qui construit votre site statique, le versionner sur une\nautre branche. J‚Äôai pour ma part choisi de nommer cette branche <code class=\"language-text\">develop</code>.</li>\n<li>Si c‚Äôest un d√©p√¥t de projet vous pourrez choisir dans les param√®tres du d√©p√¥t\nquelle branche sera disponible √† l‚Äôh√©bergement sur le domaine\n<code class=\"language-text\">https://username.github.io/repository</code>. A noter qu‚Äôil est √©galement possible\nde donner le dossier <code class=\"language-text\">docs/</code> afin d‚Äô√©viter d‚Äôavoir deux branches diff√©rentes\nentre le projet et sa documentation.</li>\n</ul>\n<p>Pour r√©sumer, avant de tout automatiser, je devais √©crire mes articles, <em>commit</em>\net <em>push</em> sur <code class=\"language-text\">develop</code> pour versionner mon code et mes articles, puis lancer\n<code class=\"language-text\">npm run build</code> et enfin <em>commit</em> sur la branche <code class=\"language-text\">master</code> seulement les fichiers\nconstruits par la commande de <code class=\"language-text\">build</code> pour ensuite <em>push</em> tout √ßa.</p>\n<p>Ma r√©action face √† toutes ces commandes :</p>\n<p><img src=\"/dbd776ff5dc0ded194e4a964a3553fae/choque.gif\" alt=\"Gif me repr√©sentant choqu√© en voyant toutes les commandes √† lancer\"></p>\n<p>C‚Äôest contraignant, et j‚Äôai donc d√©cid√© de me simplifier la t√¢che avec une\nbiblioth√®que <code class=\"language-text\">npm</code>: <code class=\"language-text\">gh-pages</code>.</p>\n<h2>gh-pages</h2>\n<p>La biblioth√®que <a href=\"https://www.npmjs.com/package/gh-pages\">gh-pages</a> permet de se simplifier la vie pour d√©ployer son site\nstatique sur les <a href=\"https://pages.github.com/\">Github Pages</a>. Avec elle, plus besoin de faire de <em>commit</em> sur\n<code class=\"language-text\">master</code> et <em>push</em> sur Github, car une fois configur√©e, elle le fait\nautomatiquement pour nous en une seule commande.</p>\n<p>Il ne me restait plus que deux commandes √† lancer √† partir de maintenant pour\nmettre le blog √† jour:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> run build\n<span class=\"token function\">npm</span> run deploy</code></pre></div>\n<p>Du coup, pourquoi ne pas optimiser encore et n‚Äôen faire qu‚Äôune seule, car si je\nveux d√©ployer le nouveau site, il faut de toute fa√ßon que je le construise\navant dans tous les cas ! J‚Äôai donc obtenu la commande <code class=\"language-text\">deploy</code> suivante :</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">// ...</span>\n<span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"gatsby build\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"develop\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"gatsby develop\"</span><span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token property\">\"deploy\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"gatsby build &amp;&amp; gh-pages -d public -b master\"</span><span class=\"token punctuation\">,</span></span>  <span class=\"token property\">\"format\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"prettier --write src/**/*.{js,jsx}\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"start\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm run develop\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"gatsby serve\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"jest\"</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p>On lui dit de <code class=\"language-text\">build</code> le site, puis de ne <em>commit</em> que le dossier <code class=\"language-text\">public/</code> sur\nla branche <code class=\"language-text\">master</code>. Ainsi, j‚Äô√©cris mes articles, et je n‚Äôai plus qu‚Äô√† lancer\nune seule commande:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"gatsby-highlight-code-line\"><span class=\"token function\">npm</span> run deploy</span></code></pre></div>\n<p>OK, parfait, je gagne quelques secondes petit √† petit. Mais bon, j‚Äôai toujours\nune commande √† lancer pour mettre √† jour mon site‚Ä¶</p>\n<p><img src=\"https://media.giphy.com/media/FdmPbRxNRGNvq/giphy.gif\" alt=\"Gif de la s√©rie Unbreakable Kimmy Schmidt qui repr√©sente ma fain√©antise\"></p>\n<p>C‚Äôest l√† que les <a href=\"https://github.com/features/actions\">Github Actions</a> entrent en jeu !</p>\n<h2>Github Actions</h2>\n<p>Les <a href=\"https://github.com/features/actions\">Github Actions</a> sont une fonctionnalit√© encore en b√™ta pour le moment, il\nfaut s‚Äôinscrire sur une liste d‚Äôattente pour en b√©n√©ficier.</p>\n<p>On peut consid√©rer cette nouvelle fonctionnalit√© comme une alternative √† des\nservices de CI/CD existant d√©j√† sur le march√©. Ce n‚Äôest pas aussi puissant, mais\npour mes besoins pour le blog, c‚Äôest largement suffisant.</p>\n<p>Les Github Actions peuvent √™tre √©dit√©es sous deux formes :</p>\n<ol>\n<li>Textuellement</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"workflow\"><pre class=\"language-workflow\"><code class=\"language-workflow\">workflow &quot;Build and Deploy Blog&quot; {\n  on = &quot;push&quot;\n  resolves = [&quot;Deploy Blog&quot;]\n}\n\naction &quot;Install packages&quot; {\n  uses = &quot;actions/npm@59b64a598378f31e49cb76f27d6f3312b582f680&quot;\n  args = &quot;install&quot;\n}\n\naction &quot;Build Blog&quot; {\n  uses = &quot;actions/npm@59b64a598378f31e49cb76f27d6f3312b582f680&quot;\n  needs = [&quot;Install packages&quot;]\n  args = &quot;run build&quot;\n}\n\naction &quot;Deploy Blog&quot; {\n  needs = &quot;Build Blog&quot;\n  uses = &quot;peaceiris/actions-gh-pages@v1.0.1&quot;\n  env = {\n    PUBLISH_DIR = &quot;./public&quot;\n    PUBLISH_BRANCH = &quot;master&quot;\n  }\n  secrets = [\n    &quot;ACTIONS_DEPLOY_KEY&quot;,\n  ]\n}</code></pre></div>\n<ol start=\"2\">\n<li>Graphiquement</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 135.22205206738133%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGQABAAIDAAAAAAAAAAAAAAAAAAIDAQQF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB7tOxSAXRkIMj/8QAGBABAQEBAQAAAAAAAAAAAAAAAgEAAyD/2gAIAQEAAQUCz7DnR0LmQKsMPq7/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAACAgMBAAAAAAAAAAAAAAAAAQIRECAhMf/aAAgBAQAGPwIqTLjjsUzxLf8A/8QAGxABAQADAAMAAAAAAAAAAAAAAREAEDEhUWH/2gAIAQEAAT8hIrlLB7zK8Us5q5Y9phEPkNK3Le+N9Z//2gAMAwEAAgADAAAAEDPuAv/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB0QAQACAgIDAAAAAAAAAAAAAAERIQAQQXExUWH/2gAIAQEAAT8QYgjDccZMUQhascFNjC9Ua6LLGMTMqDXfeiIKPeCmhUxfP3R5dH//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Capture d&#39;√©cran du mode graphique pour les actions Github\"\n        title=\"Capture d&#39;√©cran du mode graphique pour les actions Github\"\n        src=\"/static/c731482f1a9e1b0f30a42f28910cc91e/c739e/github-actions-graphical-editor.jpg\"\n        srcset=\"/static/c731482f1a9e1b0f30a42f28910cc91e/8ee9c/github-actions-graphical-editor.jpg 148w,\n/static/c731482f1a9e1b0f30a42f28910cc91e/ebbe7/github-actions-graphical-editor.jpg 295w,\n/static/c731482f1a9e1b0f30a42f28910cc91e/c739e/github-actions-graphical-editor.jpg 590w,\n/static/c731482f1a9e1b0f30a42f28910cc91e/9eaf8/github-actions-graphical-editor.jpg 653w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Il est possible d‚Äôutiliser des secrets, ce qui est pratique dans mon cas pour\nsimuler un commit de ma part depuis les actions. Reprenons ensemble le fichier\nd‚Äôaction bloc par bloc :</p>\n<div class=\"gatsby-highlight\" data-language=\"workflow\"><pre class=\"language-workflow\"><code class=\"language-workflow\">workflow &quot;Build and Deploy Blog&quot; {\n  on = &quot;push&quot;\n  resolves = [&quot;Deploy Blog&quot;]\n}</code></pre></div>\n<p>Ce premier bloc d√©fini le nom du <em>workflow</em>, l‚Äô√©v√©nement √† √©couter pour se\nlancer (ici le <code class=\"language-text\">push</code>) et d√©fini √©galement quelle est l‚Äôaction qui termine le\n<em>workflow</em>.</p>\n<div class=\"gatsby-highlight\" data-language=\"workflow\"><pre class=\"language-workflow\"><code class=\"language-workflow\">action &quot;Install packages&quot; {\n  uses = &quot;actions/npm@59b64a598378f31e49cb76f27d6f3312b582f680&quot;\n  args = &quot;install&quot;\n}</code></pre></div>\n<p>Cette premi√®re action installe les paquets n√©cessaires √† la bonne construction\ndu projet. Elle utilise une image d‚Äôaction <code class=\"language-text\">npm</code> sur le <em>commit</em> <code class=\"language-text\">59b64a</code>. Il\nsuffit de donner √† cette image un argument, qui est ici <code class=\"language-text\">install</code>, car on\nsouhaite lancer <code class=\"language-text\">npm install</code> dans le <em>workflow</em>.</p>\n<div class=\"gatsby-highlight\" data-language=\"workflow\"><pre class=\"language-workflow\"><code class=\"language-workflow\">action &quot;Build Blog&quot; {\n  uses = &quot;actions/npm@59b64a598378f31e49cb76f27d6f3312b582f680&quot;\n  needs = [&quot;Install packages&quot;]\n  args = &quot;run build&quot;\n}</code></pre></div>\n<p>La deuxi√®me action d√©pend de la bonne r√©solution de l‚Äôaction pr√©c√©dente\n<code class=\"language-text\">needs = [&quot;Install packages&quot;]</code> et construit le site statique <code class=\"language-text\">npm run build</code></p>\n<div class=\"gatsby-highlight\" data-language=\"workflow\"><pre class=\"language-workflow\"><code class=\"language-workflow\">action &quot;Deploy Blog&quot; {\n  needs = &quot;Build Blog&quot;\n  uses = &quot;peaceiris/actions-gh-pages@v1.0.1&quot;\n  env = {\n    PUBLISH_DIR = &quot;./public&quot;\n    PUBLISH_BRANCH = &quot;master&quot;\n  }\n  secrets = [\n    &quot;ACTIONS_DEPLOY_KEY&quot;,\n  ]\n}</code></pre></div>\n<p>Cette troisi√®me action n‚Äôest pas comme les autres car elle utilise une image\nqui n‚Äôest pas <code class=\"language-text\">npm</code>. Ici, on utilise l‚Äôimage <code class=\"language-text\">peaceiris/actions-gh-pages</code> qui\npermet de d√©ployer sur les Github Pages. Il suffit de lui passer les bons\nparam√®tres d‚Äôenvironnements ainsi que le secret n√©cessaire pour permettre √†\nl‚Äôimage de faire le <em>commit</em> en notre nom.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.09549071618037%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3qAH/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABPyF//9oADAMBAAIAAwAAABCDz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAAICAwAAAAAAAAAAAAAAAAABESExQWH/2gAIAQEAAT8QSzojrLP/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Capture d&#39;√©cran des secrets dans les param√®tres Github\"\n        title=\"Capture d&#39;√©cran des secrets dans les param√®tres Github\"\n        src=\"/static/330c04180618af4f5b059821e638ef85/c739e/github-settings-secrets.jpg\"\n        srcset=\"/static/330c04180618af4f5b059821e638ef85/8ee9c/github-settings-secrets.jpg 148w,\n/static/330c04180618af4f5b059821e638ef85/ebbe7/github-settings-secrets.jpg 295w,\n/static/330c04180618af4f5b059821e638ef85/c739e/github-settings-secrets.jpg 590w,\n/static/330c04180618af4f5b059821e638ef85/dde38/github-settings-secrets.jpg 754w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<hr>\n<blockquote>\n<p>üí° Pour en savoir plus sur les Github Actions, je recommande\n<a href=\"https://css-tricks.com/introducing-github-actions/\">ce tr√®s bon article</a>\n√©crit par <a href=\"https://twitter.com/sarah_edo\">Sarah Drasner</a>.</p>\n</blockquote>\n<hr>\n<p>Et voil√†, nous avons maintenant tout automatiser gr√¢ce aux Github Actions, d√®s\nque je <em>commit</em> et <em>push</em> des nouveaut√©s, elles sont automatiquement construites\net d√©ploy√©es. On dispose √©galement d‚Äôun suivi de succ√®s ou d‚Äô√©checs ainsi que\ndes logs pour faciliter le d√©bogage si besoin.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 108.93617021276596%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAWABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHu47SWkAgL/8QAGRAAAgMBAAAAAAAAAAAAAAAAAREAAxAg/9oACAEBAAEFAobEXh5//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAGBAAAgMAAAAAAAAAAAAAAAAAABEiMJH/2gAIAQEABj8CFLKP/8QAHRAAAQMFAQAAAAAAAAAAAAAAAQAQESFBcYHR8P/aAAgBAQABPyEaQ5wLE2D1Vd1gURLf/9oADAMBAAIAAwAAABBY5/7/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAfEAEAAgEDBQAAAAAAAAAAAAABABEhMWFxEEFRgfH/2gAIAQEAAT8QY3cWJhWWD7nCPXljRw2fOhU5dXtvMiwR8ymf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Capture d&#39;√©cran des logs des Github Actions\"\n        title=\"Capture d&#39;√©cran des logs des Github Actions\"\n        src=\"/static/9fcf059b0685cd54b1d160b7a8fa2dd9/c739e/github-actions-log.jpg\"\n        srcset=\"/static/9fcf059b0685cd54b1d160b7a8fa2dd9/8ee9c/github-actions-log.jpg 148w,\n/static/9fcf059b0685cd54b1d160b7a8fa2dd9/ebbe7/github-actions-log.jpg 295w,\n/static/9fcf059b0685cd54b1d160b7a8fa2dd9/c739e/github-actions-log.jpg 590w,\n/static/9fcf059b0685cd54b1d160b7a8fa2dd9/9393f/github-actions-log.jpg 705w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Vous avez maintenant toutes les clefs en main pour cr√©er vous m√™me votre blog\net le d√©ployer automatiquement, et tout √ßa, pour 0‚Ç¨.</p>\n<p>J‚Äôesp√®re avoir fait le tour du propri√©taire le plus clairement possible, si\nquestion il y a, je suis toujours disponible sur\n<a href=\"https://twitter.com/yoannfleurydev\">Twitter</a> et je r√©pondrais avec plaisir.</p>","frontmatter":{"title":"Automatisation du d√©ploiement du blog","date":"10/07/2019","description":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/automatisation-de-la-publication-du-blog/","previous":{"fields":{"slug":"/mise-en-place-de-ce-blog/"},"frontmatter":{"title":"Mise en place de ce blog"}},"next":{"fields":{"slug":"/environnement-de-travail-physique/"},"frontmatter":{"title":"Environnement de travail physique"}}}}}